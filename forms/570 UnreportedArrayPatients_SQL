SELECT Patients.PatientID, Status.Status AS PatientStatus, Status_1.Status AS ArrayStatus, ArrayTest.Priority, ArrayTest.SpecimenNo AS ArraySpecimenNo, [LASTNAME] & " " & [FIRSTNAME] AS Name, ArrayTest.RequestedDate, Checker.Initials AS MokaAuthoriser, dbo_CytoFISHReportLinked.AuthorizedByUserInitials AS GeneworksAuthoriser, DateDiff("d",[dbo_Specimenlinked].[DateReceived],Now()) AS DaysSinceSpecimenReceipt, DateDiff("d",ArrayTest.RequestedDate,Now()) AS DaysSinceArrayRequest, Patients.InternalPatientID, Referral.Referral
FROM (((((((ArrayTest INNER JOIN Patients ON ArrayTest.InternalPatientID = Patients.InternalPatientID) LEFT JOIN Status ON Patients.s_StatusOverall = Status.StatusID) LEFT JOIN dbo_Patient ON Patients.PatientID = dbo_Patient.PatientID) LEFT JOIN Referral ON ArrayTest.ReferralID = Referral.ReferralID) LEFT JOIN Status AS Status_1 ON ArrayTest.StatusID = Status_1.StatusID) LEFT JOIN dbo_specimenlinked ON ArrayTest.SpecimenNo = dbo_specimenlinked.SpecimenTrustID) LEFT JOIN dbo_CytoFISHReportLinked ON dbo_specimenlinked.SpecimenID = dbo_CytoFISHReportLinked.SpecimenID) LEFT JOIN Checker ON ArrayTest.Check4ID = Checker.Check1ID
WHERE (((ArrayTest.RequestedDate)>Now()-365 And (ArrayTest.RequestedDate)<=Now()-35) AND ((Status_1.StatusID) Not In (4,5,1202218787,1168443127,1168443128)) AND ((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID) Not In (1,8,9,10,615006209,1181125722,1185356875,1185356878,1185356879,1185356883,1185356884,1185356885,1185356887,1185356888,1185356889,1185356890,1185356891,1185356892,1185356893,1185356894,1199901147,1199901168,1199901170,1199901183,1199901184,1199901189,1199901190,1199901192,1199901193,1199901198,1199901200,1199901203,1199901205,1199901206,1199901207,1199901224))) OR (((ArrayTest.RequestedDate)>Now()-365 And (ArrayTest.RequestedDate)<=Now()-35) AND ((Status_1.StatusID) In (4,5,1168443127,1168443128)) AND ((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID) Not In (1,8,9,10,615006209,1181125722,1185356875,1185356878,1185356879,1185356883,1185356884,1185356885,1185356887,1185356888,1185356889,1185356890,1185356891,1185356892,1185356893,1185356894,1199901147,1199901168,1199901170,1199901183,1199901184,1199901189,1199901190,1199901192,1199901193,1199901198,1199901200,1199901203,1199901205,1199901206,1199901207,1199901224,1185356880,1185356882,1185356886,1199901151,1199901187,1199901194,1199901176,1199901197)) AND ((IsNull([dbo_CytoFISHReportLinked].[AuthorizedByUserInitials]))<>False)) OR (((ArrayTest.RequestedDate)>Now()-365 And (ArrayTest.RequestedDate)<=Now()-35) AND ((Status_1.StatusID) In (4,5,1168443127,1168443128)) AND ((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID) In (1185356886,1199901176,1199901197)) AND ((IsNull([Checker].[Initials]))<>False))
ORDER BY ArrayTest.RequestedDate;
