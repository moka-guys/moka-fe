SELECT Patients.PatientID, Status.Status AS PatientStatus, Status_1.Status AS ArrayStatus, ArrayTest.Priority, ArrayTest.SpecimenNo AS ArraySpecimenNo, [LASTNAME] & " " & [FIRSTNAME] AS Name, ArrayTest.RequestedDate, Checker.Initials AS MokaAuthoriser, dbo_CytoFISHReportLinked.AuthorizedByUserInitials AS GeneworksAuthoriser, DateDiff("d",[dbo_Specimenlinked].[DateReceived],Now()) AS DaysSinceSpecimenReceipt, DateDiff("d",ArrayTest.RequestedDate,Now()) AS DaysSinceArrayRequest
FROM ((((((ArrayTest INNER JOIN Patients ON ArrayTest.InternalPatientID = Patients.InternalPatientID) LEFT JOIN Status ON Patients.s_StatusOverall = Status.StatusID) LEFT JOIN dbo_Patient ON Patients.PatientID = dbo_Patient.PatientID) LEFT JOIN Status AS Status_1 ON ArrayTest.StatusID = Status_1.StatusID) LEFT JOIN dbo_specimenlinked ON ArrayTest.SpecimenNo = dbo_specimenlinked.SpecimenTrustID) LEFT JOIN dbo_CytoFISHReportLinked ON dbo_specimenlinked.SpecimenID = dbo_CytoFISHReportLinked.SpecimenID) LEFT JOIN Checker ON ArrayTest.Check4ID = Checker.Check1ID
WHERE (((ArrayTest.RequestedDate)>Now()-365 And (ArrayTest.RequestedDate)<=Now()-35) AND ((Status_1.StatusID) Not In (4,5,1202218787,1168443128,1168443127)) AND ((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID) Not In (1199901184,1199901224,1199901193,1199901206,1199901207,1199901190,1199901205,1199901203,9))) OR (((ArrayTest.RequestedDate)>Now()-365 And (ArrayTest.RequestedDate)<=Now()-35) AND ((Status_1.StatusID) In (4,1168443127)) AND ((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID) Not In (1199901184,1199901224,1199901193,1199901206,1199901207,1199901190,1199901205,1199901203,9)) AND ((IsNull([Checker].[Initials]))<>False)) OR (((ArrayTest.RequestedDate)>Now()-365 And (ArrayTest.RequestedDate)<=Now()-35) AND ((Status_1.StatusID) In (4,1168443127)) AND ((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID) Not In (1199901184,1199901224,1199901193,1199901206,1199901207,1199901190,1199901205,1199901203,9)) AND ((IsNull([dbo_CytoFISHReportLinked].[AuthorizedByUserInitials]))<>False))
ORDER BY ArrayTest.RequestedDate;
